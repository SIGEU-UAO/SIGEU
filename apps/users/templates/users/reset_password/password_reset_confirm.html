{% extends 'users/layouts/form.html' %}
{% load static %}

{% block page_title %}Crear Nueva Contrase√±a{% endblock page_title %}

{% block css_files %}
    <link rel="stylesheet" href="{% static 'users/css/base-users.css' %}">
    <link rel="stylesheet" href="{% static 'users/css/inicio_sesion.css' %}">
{% endblock css_files %}

{% block js_files %}
    <script defer type="module" src="{% static 'users/js/password_reset_confirm.js' %}"></script>
{% endblock js_files %}

{% block content %}
{% if validlink %}
    <form class="form form--reset" method="POST">
        {% csrf_token %}
        
        <h1 class="form__title">Nueva Contrase√±a üîê</h1>
        <p class="form__description">
            Ingresa tu nueva contrase√±a. Aseg√∫rate de que sea segura y f√°cil de recordar para ti.
        </p>
        
        <div class="form__group">
            <label for="id_new_password1" class="form__label">Nueva Contrase√±a:</label>
            {{ form.new_password1 }}
            {% if form.new_password1.errors %}
                <div class="form__error">
                    {% for error in form.new_password1.errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}
            <div class="form__icons">
                <button type="button" class="icon__btn" title="Mostrar/Ocultar contrase√±a">
                    <i class="ri-eye-fill"></i>
                </button>
                <button type="button" class="icon__btn" title="Informaci√≥n sobre contrase√±as">
                    <i class="ri-information-2-fill"></i>
                </button>
            </div>
        </div>
        
        <div class="form__group">
            <label for="id_new_password2" class="form__label">Confirmar Nueva Contrase√±a:</label>
            {{ form.new_password2 }}
            {% if form.new_password2.errors %}
                <div class="form__error">
                    {% for error in form.new_password2.errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}
            <div class="form__icons">
                <button type="button" class="icon__btn" title="Mostrar/Ocultar contrase√±a">
                    <i class="ri-eye-fill"></i>
                </button>
            </div>
        </div>
        
        <div class="form__info">
            <h3>Requisitos de la contrase√±a:</h3>
            <ul>
                <li>M√≠nimo 8 caracteres</li>
                <li>Al menos una letra may√∫scula</li>
                <li>Al menos una letra min√∫scula</li>
                <li>Al menos un n√∫mero</li>
                <li>Al menos un car√°cter especial</li>
            </ul>
        </div>
        
        <div class="form__actions">
            <button type="submit" class="form__button">Cambiar Contrase√±a</button>
        </div>
    </form>

{% else %}
    <!-- Enlace inv√°lido o expirado -->
    <div class="form form--message form--error">
        <div class="form__icon">
            <i class="ri-error-warning-line"></i>
        </div>
        
        <h1 class="form__title">Enlace No V√°lido ‚ö†Ô∏è</h1>
        
        <p class="form__description">
            El enlace de restablecimiento de contrase√±a no es v√°lido o ha expirado.
        </p>
        
        <div class="form__info">
            <h3>Posibles causas:</h3>
            <ul>
                <li>El enlace ya fue utilizado</li>
                <li>El enlace ha expirado (v√°lido por 24 horas)</li>
                <li>El enlace est√° mal formado</li>
            </ul>
        </div>
        
        <div class="form__actions">
            <a href="{% url 'password_reset' %}" class="form__button">Solicitar Nuevo Enlace</a>
            <p class="form__secondary">
                <a href="{% url 'inicio_sesion' %}" class="form__link">‚Üê Volver al Inicio de Sesi√≥n</a>
            </p>
        </div>
    </div>
{% endif %}
{% endblock content %}
